<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hacktopus404/frontend â€” Folder Explorer</title>

    <!-- Correctly encoded SVG favicon -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='gold'%3E%3Cpath d='M10 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z'/%3E%3C/svg%3E"
    />

    <style>
      * {
        -webkit-tap-highlight-color: transparent;
        box-sizing: border-box;
        cursor: url('https://sweezy-cursors.com/wp-content/uploads/cursor/minecraft-enchanted-diamond-sword-animated/minecraft-enchanted-diamond-sword-animated-pointer-32x32.png'), auto !important;
      }
      body {
        font-family: monospace;
        background: #0d1117;
        color: #c9d1d9;
        padding: 20px;
        font-size: 1rem;
      }
      h2 {
        color: #58a6ff;
        margin-bottom: 8px;
      }

      ul {
        display: inline-block;
        list-style-type: none;
        padding-left: 16px;
        margin: 0;
      }
      li {
        line-height: 1.7;
        position: relative;
        cursor: url('https://sweezy-cursors.com/wp-content/uploads/cursor/minecraft-enchanted-golden-sword-animated/minecraft-enchanted-golden-sword-animated-pointer-32x32.png'), pointer !important;
      }

      li.folder::before {
        content: "â–¶";
        display: inline-block;
        margin-left: 5.5px;
        margin-right: 0.3em;
        transition: transform 0.18s ease;
        width: 16px;
      }
      li.folder.open::before {
        transform: rotate(90deg);
      }
      li.folder.open {
        color: #79c0ff;
      }

      li.file::before {
        content: "ðŸ“„ ";
      }
      li.file {
        margin-left: 3.5px;
        cursor: pointer;
      }
      li.file:hover {
        color: #79c0ff;
      }

      li.folder {
        cursor: pointer;
        user-select: none;
      }
      li.folder:hover {
        color: #79c0ff;
      }

      li.folder > ul {
        margin-left: 14px;
        border-left: 1px dashed #30363d;
        padding-left: 8px;
        display: none;
      }
      li.folder.open > ul {
        color: #c9d1d9;
        display: block;
        animation: fadeIn 0.15s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      li.file.html-file {
        color: #ff5555;
      }
      li.file.html-file:hover {
        color: #ffd700;
      }

      .loading {
        opacity: 0.6;
        color: #8b949e;
      }
    </style>
  </head>
  <body>
    <h2>ðŸ“‚ Hacktopus404/frontend â€” Folder Explorer</h2>
    <ul id="repo-tree"></ul>

    <script>
      const owner = "Hacktopus404";
      const repo = "frontend";
      const baseUrl = `https://api.github.com/repos/${owner}/${repo}/contents`;
      const pagesBase = `https://${owner}.github.io/${repo}`;
      const ignoredFiles = ["LICENSE", "README.md"];

      // Fetch contents of a folder (with User-Agent header fix)
      async function fetchFolder(path = "") {
        const url = `${baseUrl}/${path}`;
        const res = await fetch(url, {
          headers: {
            "User-Agent": "FolderExplorer",
            Accept: "application/vnd.github+json",
          },
        });

        const data = await res.json();
        if (!Array.isArray(data)) return [];

        return data
          .filter((item) => {
            if (ignoredFiles.includes(item.name)) return false;
            if (path === "" && item.name.toLowerCase() === "index.html")
              return false;
            return true;
          })
          .sort((a, b) =>
            a.type === b.type
              ? a.name.localeCompare(b.name)
              : a.type < b.type
              ? 1
              : -1
          );
      }

      // Render folders/files
      async function renderFolder(path = "", parentUl) {
        const items = await fetchFolder(path);
        parentUl.innerHTML = ""; // clear "Loading..."

        for (const item of items) {
          const li = document.createElement("li");
          li.textContent = item.name;
          li.classList.add(item.type);
          parentUl.appendChild(li);

          if (item.type === "dir") {
            const nestedUl = document.createElement("ul");
            li.appendChild(nestedUl);
            li.classList.add("folder", "collapsed");

            li.addEventListener("click", async (e) => {
              e.stopPropagation();
              const isOpen = li.classList.toggle("open");
              if (isOpen && !nestedUl.hasChildNodes()) {
                nestedUl.innerHTML = "<li class='loading'>Loading...</li>";
                await renderFolder(item.path, nestedUl);
              }
            });
          } else {
            li.classList.add("file");
            if (item.name.toLowerCase().endsWith(".html"))
              li.classList.add("html-file");

            li.addEventListener("click", (e) => {
              e.stopPropagation();

              // Encode only the file name, not slashes
              const parts = item.path.split("/");
              const fileName = parts.pop();
              const folderPath = parts.join("/");

              const fileUrl = `${pagesBase}/${folderPath}/${encodeURIComponent(
                fileName
              )}`;
              window.open(fileUrl, "_blank");
            });
          }
        }
      }

      // Load root
      renderFolder("", document.getElementById("repo-tree"));
    </script>
  </body>
</html>

